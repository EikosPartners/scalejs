<!DOCTYPE html>
<html>
<head>
    
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <link rel="stylesheet" href="style/metro-bootstrap.min.css" />
	  <link rel="stylesheet" href="style/metro-bootstrap-responsive.min.css" />
    <script src="style/jquery.min.js"></script>
	  <script src="style/jquery.ui.widget.js"></script>	
    <script src="style/metro.min.js"></script>
	  <link rel="stylesheet" href="highlight.css" />

	<meta name="generator" content="DocPad v6.60.4" />
	<link  rel="stylesheet" href="highlight.css" />
    
	<style>
    header {
      height: 45px;
    }
    #content {
      overflow-y: scroll;
	  padding-right: 20px;
	  margin-left: 20px;
    }
    #sidebar {
      display: block;
      float: left;
      width: 300px;
      overflow-y: scroll;
      margin-right:20px;
    }
    body {
      overflow-y: hidden;
     }
	.metro h1 {
		color: #9a1616 !important;
	}	
	.metro .sidebar>ul ul, .metro .sidebar>ul ul li a {
		background-color: #3d3d3d;
		border: 0px;
		color: #fff;
	}
  </style>
    
	<script>
	function adjustHeight() {
		//adjust the height of the content and sidebar
		$("#content").outerHeight(window.innerHeight -45);
		$("#sidebar").outerHeight(window.innerHeight -45);
	}

    $(document).ready(function() {
		var path = window.location.pathname.replace("/scalejs/scalejs-docs/out","");
		
		//make selected page active on sidebar
		$("a[href='." + path +"']").parent().addClass("active");

		adjustHeight();
		$(window).resize(adjustHeight);

		//create code highlighting
		$('pre').each(function() {
			$(this).html($(this).html().replace(/!!\*/g, "<i style='background-color:#FFFF99'>").replace(/\*\*!/g, "</i>"));
		});

		console.log(path);
		//expand grid if it is grid
		if(path === '/grid1.html' || path === '/grid2.html') $('#grid-dropdown').css("display","block");
    });

  </script>
</head>
<body class="metro">

  <header>
	  <nav class="navigation-bar dark fixed-top">
    <div class="navigation-bar-content">
        <a href="./" class="element"><span class="icon-home"></span> SCALEJS</a>
        <span class="element-divider"></span>

        <a class="element1 pull-menu" href="#"></a>

        <ul class="element-menu no-desktop">
            <li>
                <a class="dropdown-toggle" href="#"><span class="icon-layers"></span> Docs</a>
                <ul class="dropdown-menu dark" data-role="dropdown">
                    <li>
                        <a href="#" class="dropdown-toggle">Getting Started</a>
                        <ul class="dropdown-menu dark" data-role="dropdown">
                            <li><a href="./docs.html"><i class="icon-star-3"></i> Introduction</a></li>
                            <li><a href="./install.html"><i class="icon-download-2"></i> Install Scalejs</a></li>
                            <li><a href="./project.html"><i class="icon-new"></i> Create an Application Project</a></li>
                            <!--<li><a href="./build.html"><i class="icon-cloud"></i> Build and Deployment</a></li>
                            <li><a href="./test.html"><i class="icon-checkmark"></i> Testing</a></li>
                            <li><a href="./best.html"><i class="icon-thumbs-up"></i> Best Practices</a></li>-->
                        </ul>
                    </li>
                    <li>
                        <a href="#" class="dropdown-toggle">Overview</a>
                        <ul class="dropdown-menu dark" data-role="dropdown">
                            <li><a href="./template.html"><i class="icon-clipboard-2"></i> Project Template</a></li>
                            <li><a href="./architecture.html"><i class="icon-puzzle"></i> Architecture</a></li>
                            <li><a href="./mvvm.html"><i class="icon-tree-view"></i> Model-View-ViewModel</a></li>
                            <li><a href="./statechart.html"><i class="icon-tab"></i> Statechart</a></li>
                            <li><a href="./routing.html"><i class="icon-share"></i> Routing</a></li>
                            <li><a href="./composition.html"><i class="icon-screen"></i> UI Composition</a></li>
                            <li><a href="./gridlayout.html"><i class="icon-grid-view"></i> Grid Layout</a></li>
                            <!-- <li><a href="./styles.html"><i class="icon-droplet"></i> Styles</a></li>
                            <li><a href="./extensions.html"><i class="icon-wrench"></i> Extensions</a></li>
                            <li><a href="./api.html"><i class="icon-book"></i> API Documentation</a></li>-->
                        </ul>
                    </li>
                    <li>
                        <a href="#" class="dropdown-toggle">UI Components</a>
                        <ul class="dropdown-menu dark" data-role="dropdown">
                            <li>
                                <a class="dropdown-toggle" href=""><i class="icon-grid"></i> Grid</a>
                                <ul class="dropdown-menu" data-role="dropdown">
                                    <li><a href="./grid1.html">Introduction</a></li>
                                    <li><a href="./grid2.html">Filtering</a></li>
                                    <!--<li><a href="./grid3.html">Sorting</a></li>-->
                                </ul>
                            </li>
                        </ul>
                    </li>
                    <li>
                        <a href="#" class="dropdown-toggle">Tutorials</a>
                        <ul class="dropdown-menu dark" data-role="dropdown">
                            <li><a href="./todomvc.html">ToDoMVC</a></li>
                        </ul>
                    </li>
                </ul>
            </li>
            <li class="divider"></li>
            <li><a title="Visual Studio Gallery" href="http://visualstudiogallery.msdn.microsoft.com/2a3d0050-ccab-458f-8bfc-2f2aca73e631"><span class="icon-box-add"></span> Visual Studio</a></li>
            <li class="divider"></li>
            <li><a title="GitHub" href="https://github.com/lisovin/scalejs/tree/master"><span class="icon-github-3"></span> GitHub</a></li>
        </ul>

        <div class="no-tablet-portrait no-phone">
            <a href="./docs.html" class="element"><span class="icon-layers"></span> Docs</a>
            <span class="element-divider"></span>

            <a title="Visual Studio Gallery" href="http://visualstudiogallery.msdn.microsoft.com/2a3d0050-ccab-458f-8bfc-2f2aca73e631" class="element place-right"><span class="icon-box-add"></span> Visual Studio</a>
            <span class="element-divider place-right"></span>

            <a title="GitHub" href="https://github.com/lisovin/scalejs/tree/master" class="element place-right"><span class="icon-github-3"></span> GitHub</a>
            <span class="element-divider place-right"></span>
        </div>
    </div>
</nav>
  </header>
  
  <div id="container">
     
       <div id="sidebar" class="sidebar no-tablet-portrait no-phone">
		      <ul>
			      <li class="title">Getting Started</li>
				      <li><a href="./docs.html"><i class="icon-star-3"></i> Introduction</a></li>
				      <li><a href="./install.html"><i class="icon-download-2"></i> Install Scalejs</a></li>
				      <li><a href="./project.html"><i class="icon-new"></i> Create an Application Project</a></li>
                            <!--<li><a href="./build.html"><i class="icon-cloud"></i> Build and Deployment</a></li>
                            <li><a href="./test.html"><i class="icon-checkmark"></i> Testing</a></li>
                            <li><a href="./best.html"><i class="icon-thumbs-up"></i> Best Practices</a></li>-->
			      <li class="title">Overview</li>
                            <li><a href="./template.html"><i class="icon-clipboard-2"></i> Project Template</a></li>
                            <li><a href="./architecture.html"><i class="icon-puzzle"></i> Architecture</a></li>
                            <li><a href="./mvvm.html"><i class="icon-tree-view"></i> Model-View-ViewModel</a></li>
                            <li><a href="./statechart.html"><i class="icon-tab"></i> Statechart</a></li>
                            <li><a href="./routing.html"><i class="icon-share"></i> Routing</a></li>
                            <li><a href="./composition.html"><i class="icon-screen"></i> UI Composition</a></li>
                            <li><a href="./gridlayout.html"><i class="icon-grid-view"></i> Grid Layout</a></li>
                            <!--<li><a href="./styles.html"><i class="icon-droplet"></i> Styles</a></li>
                            <li><a href="./extensions.html"><i class="icon-wrench"></i> Extensions</a></li>
                            <li><a href="./api.html"><i class="icon-book"></i> API Documentation</a></li>-->
				  <li class="title">UI Components</li>
				            <li>
								<a class="dropdown-toggle" href=""><i class="icon-grid"></i> Grid</a>
								<ul id="grid-dropdown" class="dropdown-menu" data-role="dropdown">
									<li><a href="./grid1.html">Introduction</a></li>
									<li><a href="./grid2.html">Filtering</a></li>
									<!--<li><a href="./grid3.html">Sorting</a></li>-->
								</ul>
							</li>
			      <li class="title">Tutorials</li>
				      <li><a href="./todomvc.html">ToDoMVC</a></li>
		      </ul>
	      </div>

	    <div id="content">
		    <h1 id="ui-composition">UI Composition</h1>
<hr>

<p><a href="http://scalejs.com/scalejs-examples/UIComposition/UIComposition/">UI Composition Sample</a> |
<a href="https://github.com/lisovin/scalejs-examples/tree/master/UIComposition">UI Composition GitHub</a></p>
<hr>

<p>With scalejs there is a solid way to manage the layout in a decoupled manner. 
Using a combination of the mvvm and statechart
extensions allows you to create regions for modules to render themselves without having
any modules &quot;know&quot; about other modules. It enforces loose-coupling and therefore is the
recommended approach to doing your layout. </p>
<p>Composing your UI begins in the <em>main</em> module which is the shell of your UI.
This acts as a master page for the app. It contains one or more regions. 
Regions are placeholders for content which will be loaded at runtime.
Regions are populated with the Views from other modules. 
Regions can be loaded dynamically and updated at any time in your app.
They can be accessed in a decoupled way using the statechart.</p>
<p>Think of regions as containers in which content can be dynamically loaded. 
This pattern is similar to Microsoft&#39;s prism pattern if you are familular with it.</p>
<p><br></p>
<h2 id="main-module">Main Module</h2>
<p>You may choose a different module to be the <strong>shell</strong> of your layout, however the main module
is convienient as it is included already in the project template.
This is the starting point of your layout.</p>
<h5 id="example-the-main-module-boilerplate-code">Example: The main module boilerplate code</h5>
<pre class="highlight"><code class="hljs javascript"><span class="hljs-keyword">var</span> <span class="hljs-comment">// imports</span>
    root = sandbox.mvvm.root,
    template = sandbox.mvvm.template,
    registerStates = sandbox.state.registerStates,
    state = sandbox.state.builder.state,
    onEntry = sandbox.state.builder.onEntry,
    <span class="hljs-comment">// vars</span>
    viewModel = mainViewModel();

<span class="hljs-comment">// Register application state for the module.</span>
registerStates(<span class="hljs-string">'root'</span>,
    state(<span class="hljs-string">'app'</span>,
        state(<span class="hljs-string">'main'</span>,
            onEntry(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
                <span class="hljs-comment">// Render viewModel using 'main_template' template </span>
                <span class="hljs-comment">// (defined in main.html) and show it in the `root` region.</span>
                root(template(<span class="hljs-string">'main_template'</span>, viewModel));
            }))));
</code></pre>
<p>We will examine this code and how to create regions in the layout.</p>
<p><br></p>
<h3 id="root">root</h3>
<p><code>root</code> is part of the <strong>mvvm</strong> namespace. Its purpose is to render content in the body of the HTML.
Any content which is applied to the <code>root()</code> function will completely overwrite any HTML in the body of the app.
This is useful if you are loading a completely new view into the root, but <em>most</em> of the time your root will remain unchanged.
This is because rather than changing the layout of your application, you most likely will need to change specific regions
which are already defined by the view within the root.</p>
<p>The root expects one of the following function to be passed to it: <code>dataBinding</code>, <code>dataClass</code>, or <code>template</code>.
In our experience, <code>template</code> is most commonly used because it is straight-forward and easy to understamd.</p>
<p>Root itself is a region, and behaves similarly to the regions that you will define, except the root region
contains <em>all</em> of the content on your page.</p>
<p><br></p>
<h3 id="template">template</h3>
<p><code>template</code> is a function which takes 2 parameters: a named template from the view and a viewModel to be passed to it.</p>
<h5 id="example-rendering-content-using-template-function-in-the-root-region">Example: Rendering content using template function in the root region</h5>
<pre class="highlight"><code class="hljs javascript"><span class="hljs-keyword">var</span> <span class="hljs-comment">// imports</span>
    root = sandbox.mvvm.root,
    template = sandbox.mvvm.template;

    root(template(<span class="hljs-string">'main_template'</span>, viewModel));
</code></pre>
<p>It is important to note that this code is missing the statechart which is important for maintaining the order in the app.
You do not want to render the DOM until all modules and states have been registered because these happen before your
application runs and it is better to wait for this to happen before attempting to render the layout. </p>
<p><br></p>
<h3 id="creating-regions-within-a-template">Creating regions within a template</h3>
<p>To create and render a region is a joint effort between the view, viewmodel, and the statechart.
In order to create a region you must:</p>
<ul>
<li>Define the region in the view using the <code>render</code> binding</li>
<li>Bind the region to an observable declared within the viewModel</li>
</ul>
<p>The <code>render</code> binding is used to populate regions with content using an observable.
Much like the <code>root</code> function it expects a <code>dataBinding</code>, <code>dataClass</code>, or a <code>template</code>.</p>
<h5 id="example-definding-regions-using-render">Example: definding regions using  render</h5>
<pre class="highlight"><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"main_template"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">data-bind</span>=<span class="hljs-value">"render: foo"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
    <span class="hljs-comment">&lt;!-- ko render: bar--&gt;</span><span class="hljs-comment">&lt;!-- /ko --&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
</code></pre>
<p>The above example names two regions: <strong>foo</strong> and <strong>bar</strong>.
The difference between these two methods of naming regions is that the content of
<strong>foo</strong> will be rendered within the div, wheras the content of
<strong>bar</strong> will be rendered within the comments. The former creates a container for the rendered template,
while the latter does not. Depending on what you need in your Layout, you can use either of these methods
to define the render binding.</p>
<p>The next step is defining <strong>foo</strong> and <strong>bar</strong> as observables within your viewModel. </p>
<h5 id="example-declaring-regions-as-observables-within-the-viewmodel">Example: declaring regions as observables within the viewmodel</h5>
<pre class="highlight"><code class="hljs javascript"><span class="hljs-comment">/*global define */</span>
define([
    <span class="hljs-string">'sandbox!main'</span>
], <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(
    sandbox
)</span> {</span>
<span class="hljs-pi">    'use strict'</span>;

    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
        <span class="hljs-keyword">var</span> <span class="hljs-comment">// imports</span>
            observable = sandbox.mvvm.observable,
            <span class="hljs-comment">// properties</span>
            foo = observable(),
            bar = observable();

        <span class="hljs-keyword">return</span> {
            foo: foo,
            bar: bar
        };
    };
});
</code></pre>
<p><br></p>
<h3 id="rendering-views-within-the-regions">Rendering views within the regions</h3>
<p>In the previous section we created the regions for your layout, but in order for other modules to access the regions they must
be exposed to other modules by adding them on the statechart.</p>
<h5 id="example-adding-regions-to-the-statechart">Example: Adding regions to the statechart</h5>
<pre class="highlight"><code class="hljs javascript">registerStates(<span class="hljs-string">'root'</span>,
    state(<span class="hljs-string">'app'</span>,
        state(<span class="hljs-string">'main'</span>,
            onEntry(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
                <span class="hljs-keyword">this</span>.foo = viewModel.foo;
                <span class="hljs-keyword">this</span>.bar = viewModel.bar;
                root(template(<span class="hljs-string">'main_template'</span>, viewModel));
            }))));
</code></pre>
<p>For another module to access these regions, it simply needs to call them from the statechart.
However one thing to keep in mind is that if it tries to access the regions <em>before</em> they 
have been added to the statechart, there will be an error. You can control this by
making the state a descedant of the state which adds the regions to the statechart.
Alternatively, you can create an interim state that waits for an event to notify
the statechart that the properties were added. You then can create a transition
that will allow your module to enter the state in which it tries to use the regions.</p>
<p>In the following example we have created a module called <strong>foobar</strong>. </p>
<h5 id="example-adding-foo-module-to-app-js">Example: Adding foo module to app.js</h5>
<pre class="highlight"><code class="hljs javascript"><span class="hljs-comment">/*global require*/</span>
<span class="hljs-built_in">require</span>([
    <span class="hljs-string">'scalejs!application/main,foobar'</span>
], <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(
    application
)</span> {</span>
<span class="hljs-pi">    'use strict'</span>;

    application.run();
});
</code></pre>
<p>It contains 2 templates that are to be rendered inside of the regions.</p>
<h5 id="example-two-templates-from-the-foobar-module-s-view-foobar-html">Example: Two templates from the foobar module&#39;s view, foobar.html</h5>
<pre class="highlight"><code class="hljs xml"><span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"foo_template"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">span</span> <span class="hljs-attribute">data-bind</span>=<span class="hljs-value">"text: fooText"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">span</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">div</span> <span class="hljs-attribute">id</span>=<span class="hljs-value">"bar_template"</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">span</span> <span class="hljs-attribute">data-bind</span>=<span class="hljs-value">"text: barText"</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">span</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">div</span>&gt;</span>
</code></pre>
<p>In order to render these templates in the regions, we need to access them similarly to how we are rendering
the main template in the root, except we are accessing the regions from the statechart.</p>
<pre class="highlight"><code class="hljs javascript">registerStates(<span class="hljs-string">'main'</span>,
    state(<span class="hljs-string">'foobar'</span>,
        onEntry(<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
            <span class="hljs-keyword">this</span>.foo(template(<span class="hljs-string">'foo_template'</span>, foobar));
            <span class="hljs-keyword">this</span>.bar(template(<span class="hljs-string">'bar_template'</span>, foobar));
        })));
</code></pre>
<p>Do not forget to ensure that the <code>foobar</code> state is entered after the <code>main</code> state.
Remember that since fooText and barText are bound in the view, they must be exposed within the viewmodel.</p>
<h5 id="example-declaring-footext-and-bartext-in-foobarviewmodel-js">Example: Declaring fooText and barText in foobarViewModel.js</h5>
<pre class="highlight"><code class="hljs javascript"><span class="hljs-comment">/*global define */</span>
define([
    <span class="hljs-string">'sandbox!foobar'</span>,
], <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(
    sandbox
)</span> {</span>
<span class="hljs-pi">    'use strict'</span>;

    <span class="hljs-keyword">return</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">()</span> {</span>
        <span class="hljs-keyword">var</span> observable = sandbox.mvvm.observable,
            fooText = observable(<span class="hljs-string">'Foo text'</span>),
            barText = observable(<span class="hljs-string">'Bar text'</span>);

        <span class="hljs-keyword">return</span> {
            fooText: fooText,
            barText: barText
        };
    };
});
</code></pre>
<p>This is the result of the composition:</p>
<p><img src="./compose.png" alt="composed"></p>
<p><br></p>
<h2 id="summary">Summary</h2>
<ul>
<li>Modules can render their content in regions</li>
<li>Regions are observables that can be specified in the main module and added to the statechart</li>
<li>Other modules can access the regions using the statechart once they have been added</li>
<li>Use the <code>template</code> function as the most straight-forward was of rending content in a region</li>
</ul>

	    </div>

  </div>
</div>
    
</body>
</html>